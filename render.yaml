services:
  - type: web
    name: donpaolo-api
    plan: free  # Change to 'starter' ($7/month) for production - always-on service
    region: oregon  # Options: oregon, frankfurt, singapore, mumbai (choose closest to users)
    buildCommand: cd Api && dotnet restore && dotnet publish -c Release -o ./publish
    startCommand: cd Api/publish && dotnet Api.dll --urls http://0.0.0.0:$PORT
    healthCheckPath: /api/Health
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ASPNETCORE_URLS
        value: http://0.0.0.0:$PORT
      - key: PORT
        value: 10000
      # Supabase Database Connection - Set manually in Render dashboard with your Supabase connection string
      - key: ConnectionStrings__DefaultConnection
        sync: false  # IMPORTANT: Set this manually with your Supabase connection string from Step 2
      # JWT Configuration - Set these manually in Render dashboard after deployment
      - key: Jwt__Key
        sync: false  # IMPORTANT: Set this manually in Render dashboard (generate with: openssl rand -base64 32)
      - key: Jwt__Issuer
        value: https://donpaolo-api.onrender.com  # Will be updated automatically with your service URL
      - key: Jwt__Audience
        sync: false  # Set this to your frontend URL (e.g., https://donpaolo.netlify.app)
      # CORS Configuration - Set this manually with your frontend URL
      - key: AllowedOrigins__0
        sync: false  # Set this to your frontend URL (e.g., https://donpaolo.netlify.app)
      # Optional: Disable Swagger in production (set to false)
      - key: EnableSwagger
        value: "true"

# Databases section removed - using Supabase instead
# To use Supabase:
# 1. Create a project on supabase.com
# 2. Get your connection string from Settings â†’ Database
# 3. Set ConnectionStrings__DefaultConnection environment variable in Render dashboard
# databases:
#   - name: donpaolo-db
#     plan: free
#     databaseName: donpaolo
#     user: donpaolo_user
#     postgresMajorVersion: 15
